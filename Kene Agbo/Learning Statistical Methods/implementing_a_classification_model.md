# Implementing a Classification Model



% Task 4: Implementing a Classification Model % Clear workspace and command window clear; clc; % Load the training data trainData = readtable('$train_$$selected.csv'); % Load the test data testData = readtable('$test_$$selected.csv'); % Extract features and target variable $X_$$class = trainData{:, {'$s1$$', '$s2$$', '$s3$$', '$s4$$'}}; $y_$$class = trainData.$label_$$bnc; % Standardize the features [$X_$$$class_$$norm, mu, sigma] = zscore($X_$$class); % Split the data into training and validation sets cv = cvpartition(size($X_$$$class_$$norm,1), 'HoldOut', 0.2); idx = cv.test; $X_$$$train_$$c = $X_$$$class_$$norm(~idx,:); $y_$$$train_$$c = $y_$$class(~idx); $X_$$$val_$$c = $X_$$$class_$$norm(idx,:); $y_$$$val_$$c = $y_$$class(idx); % Fit Logistic Regression Model using fitglm bayesModel = fitglm($X_$$$train_$$c, $y_$$$train_$$c, 'linear', 'Distribution',  'binomial', 'Link', 'logit'); % Predict probabilities on the validation set $y_$$$pred_$$prob = predict(bayesModel, $X_$$$val_$$c); % Classify based on probability threshold threshold = 0.5; $y_$$$pred_$$c = $y_$$$pred_$$prob >= threshold; % Convert both $y_$$$val_$$c and $y_$$$pred_$$c to categorical for confusion matrix $y_$$$val_$$c = categorical($y_$$$val_$$c); $y_$$$pred_$$c = categorical($y_$$$pred_$$c); % Evaluate the model [confMat,~] = confusionmat($y_$$$val_$$c, $y_$$$pred_$$c); % Initialize rowNames and columnNames as empty strings rowNames = {}; columnNames = {}; % Dynamically set row and column names based on actual size of confMat 1

if size(confMat, 1) == 2     rowNames = {'$Actual_$$No', '$Actual_$$Yes'};     columnNames = {'$Predicted_$$No', '$Predicted_$$Yes'}; elseif size(confMat, 1) == 1     if any($y_$$$val_$$c == categorical(1))         rowNames = {'$Actual_$$Yes'};         columnNames = {'$Predicted_$$Yes'};     else         rowNames = {'$Actual_$$No'};         columnNames = {'$Predicted_$$No'};     end end % Display confusion matrix with dynamically determined row names disp('Confusion Matrix:'); Confusion Matrix: if size(confMat, 1) == 2     disp($array2$$table(confMat, 'VariableNames', {'$Predicted_$$No',  '$Predicted_$$Yes'}, 'RowNames', {'$Actual_$$No', '$Actual_$$Yes'})); elseif size(confMat, 1) == 1     if any($y_$$$val_$$c == categorical(1))         disp($array2$$table(confMat, 'VariableNames', {'$Predicted_$$Yes'},  'RowNames', {'$Actual_$$Yes'}));     else         disp($array2$$table(confMat, 'VariableNames', {'$Predicted_$$No'},  'RowNames', {'$Actual_$$No'}));     end end % Calculate evaluation metrics if both classes are present if size(confMat, 1) == 2     TP = confMat(2,2);     TN = confMat(1,1);     FP = confMat(1,2);     FN = confMat(2,1);          precision = TP / (TP + FP);     recall = TP / (TP + FN);     $F1_$$score = 2 * (precision * recall) / (precision + recall);     fprintf('Precision: %.2f\n', precision);     fprintf('Recall: %.2f\n', recall);     fprintf('$F1$$-score: %.2f\n', $F1_$$score); else     disp('Only one class present in validation data; metrics cannot be  calculated.'); end 2

Only one class present in validation data; metrics cannot be calculated. % ROC Curve [Xroc, Yroc, Troc, AUC] = perfcurve(double($y_$$$val_$$c), $y_$$$pred_$$prob, 1); figure('Name', 'ROC Curve - Validation Set', 'NumberTitle', 'off'); plot(Xroc, Yroc, 'LineWidth', 1.5); hold on; plot([0,1], [0,1], '--'); title(['ROC Curve - Validation Set (AUC = ' $num2$$str(AUC, '%.2f') ')']); xlabel('False Positive Rate'); ylabel('True Positive Rate'); grid on; hold off; % Prepare test data $X_$$$test_$$c = (testData{:, {'$s1$$', '$s2$$', '$s3$$', '$s4$$'}} - mu) ./ sigma; % Predict probabilities on the test data $test_$$$pred_$$prob = predict(bayesModel, $X_$$$test_$$c); % Classify based on the same threshold $test_$$$class_$$predictions = $test_$$$pred_$$prob >= threshold; 3

fprintf('Predicted Classes for Test Data:\n'); Predicted Classes for Test Data: disp($test_$$$class_$$predictions');    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   1   0   0   1   1   1   0   0   0   1   0   1   0   0   0   0   0   0   1   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   1   0   1   0   0   0   0   0   0   0   1   1   0   0   0   1   1   0   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0   0   1 4